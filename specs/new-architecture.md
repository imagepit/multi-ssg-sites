---
title: æ–°è¦ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆæ›¸
description: ãƒãƒ«ãƒã‚µã‚¤ãƒˆãƒ»ãƒãƒ«ãƒãƒ†ãƒ¼ãƒå¯¾å¿œã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ 
---

# æ–°è¦ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆæ›¸

## æ¦‚è¦

æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€ç¾åœ¨ã®å˜ä¸€ãƒ†ãƒ¼ãƒãƒ»å˜ä¸€ãƒªãƒã‚¸ãƒˆãƒªæ§‹æˆã‹ã‚‰ã€ãƒãƒ«ãƒã‚µã‚¤ãƒˆãƒ»ãƒãƒ«ãƒãƒ†ãƒ¼ãƒå¯¾å¿œã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã¸ç§»è¡Œã™ã‚‹ãŸã‚ã®æŠ€è¡“è¨­è¨ˆã‚’å®šç¾©ã™ã‚‹ã€‚

## ç›®æ¨™

- **ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£**: è¤‡æ•°ã‚µã‚¤ãƒˆãƒ»ãƒ†ãƒ¼ãƒã‚’åŠ¹ç‡çš„ã«ç®¡ç†
- **è‡ªå‹•åŒ–**: CI/CDã«ã‚ˆã‚‹å®Œå…¨è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤
- **åç›ŠåŒ–**: æœ‰æ–™ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è²©å£²æ©Ÿèƒ½ã®å®Ÿè£…
- **é–‹ç™ºä½“é¨“**: ç¾è¡Œã®ã‚·ãƒ³ãƒ—ãƒ«ã•ã‚’ç¶­æŒã—ã¤ã¤æ©Ÿèƒ½ã‚’æ‹¡å¼µ

## ç”¨èªï¼ˆæœ¬è¨­è¨ˆæ›¸å†…ã®å‘¼ç§°ï¼‰

- **admin appï¼ˆWorkerï¼‰**: Cloudflare Workersä¸Šã§å‹•ä½œã™ã‚‹çµ±åˆç®¡ç†ã‚¢ãƒ—ãƒªã€‚ã‚µã‚¤ãƒˆ/ãƒšãƒ¼ã‚¸/ãƒ†ãƒ¼ãƒ/æœ‰æ–™ã‚³ãƒ³ãƒ†ãƒ³ãƒ„/è¨ˆæ¸¬ï¼ˆpage_viewï¼‰ç­‰ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰æ©Ÿèƒ½ã‚’æä¾›ã™ã‚‹ã€‚
- **admin UIï¼ˆPagesï¼‰**: Cloudflare Pagesä¸Šã§é…ä¿¡ã™ã‚‹ç®¡ç†ç”»é¢ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰ã€‚admin appï¼ˆWorkerï¼‰ã®HTTPã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å‘¼ã³å‡ºã—ã¦é‹ç”¨ãƒ»å¯è¦–åŒ–ã‚’è¡Œã†ã€‚

## æ–°è¦ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
techdoc/
â”œâ”€â”€ contents/                    # ã‚µã‚¤ãƒˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼ˆå„ã‚µã‚¤ãƒˆç‹¬ç«‹ãƒªãƒã‚¸ãƒˆãƒªï¼‰
â”‚   â”œâ”€â”€ v0/                    # v0ã‚µã‚¤ãƒˆï¼ˆGitHubãƒªãƒã‚¸ãƒˆãƒªã¨ã—ã¦ç‹¬ç«‹ï¼‰
â”‚   â”‚   â”œâ”€â”€ .git/
â”‚   â”‚   â”œâ”€â”€ index.md
â”‚   â”‚   â”œâ”€â”€ contents/
â”‚   â”‚   â”‚   â”œâ”€â”€ getting-started/
â”‚   â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ specs/
â”‚   â”‚   â”‚   â”œâ”€â”€ spec.json
â”‚   â”‚   â”‚   â””â”€â”€ requirement.md
â”‚   â”‚   â”œâ”€â”€ docs.config.ts     # ã‚µã‚¤ãƒˆå›ºæœ‰è¨­å®š
â”‚   â”‚   â””â”€â”€ README.md
â”‚   â”œâ”€â”€ nextjs/               # Next.jsã‚µã‚¤ãƒˆ
â”‚   â”œâ”€â”€ cloudflare/           # Cloudflareã‚µã‚¤ãƒˆ
â”‚   â””â”€â”€ [site-id]/            # å„ã‚µã‚¤ãƒˆ
â”‚
â”œâ”€â”€ themes/                    # å…±æœ‰ãƒ†ãƒ¼ãƒãƒ©ã‚¤ãƒ–ãƒ©ãƒª
â”‚   â”œâ”€â”€ fumadocs/             # æ—¢å­˜fumadocsãƒ†ãƒ¼ãƒ
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â””â”€â”€ next.config.mjs
â”‚   â”œâ”€â”€ dx-media/             # æ–°è¦ç‹¬è‡ªãƒ†ãƒ¼ãƒ
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â””â”€â”€ theme.config.ts
â”‚   â”œâ”€â”€ nextra/               # Nextraãƒ†ãƒ¼ãƒ
â”‚   â””â”€â”€ theme-registry/       # ãƒ†ãƒ¼ãƒç®¡ç†ã¨æŠ½è±¡åŒ–
â”‚       â””â”€â”€ src/
â”‚           â”œâ”€â”€ index.ts
â”‚           â”œâ”€â”€ types.ts
â”‚           â””â”€â”€ adapters/
â”‚
â”œâ”€â”€ admin/                     # admin appï¼ˆWorkerï¼‰ï¼šçµ±åˆç®¡ç†ã‚¢ãƒ—ãƒªï¼ˆCloudflare Workers: 1ã‚¢ãƒ—ãƒªã«çµ±åˆï¼‰
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ http/             # HTTPï¼ˆç®¡ç†ï¼‰ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆã‚µã‚¤ãƒˆ/ãƒšãƒ¼ã‚¸/ãƒ†ãƒ¼ãƒ/ãƒ¦ãƒ¼ã‚¶ãƒ¼/æ¨©é™/è¨ˆæ¸¬ãªã©ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”‚   â””â”€â”€ middleware/
â”‚   â”‚   â”œâ”€â”€ domains/          # ãƒ‰ãƒ¡ã‚¤ãƒ³åˆ¥ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆä¾‹: sites/pages/themes/entitlementsï¼‰
â”‚   â”‚   â”œâ”€â”€ paid-content/     # æœ‰æ–™ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼ˆJWTæ¤œè¨¼â†’æ¨©é™ç¢ºèªâ†’R2ç½²åURL/ãƒ—ãƒ­ã‚­ã‚·ï¼‰
â”‚   â”‚   â”œâ”€â”€ analytics/        # page_viewç­‰ã®ã‚¤ãƒ™ãƒ³ãƒˆå–ã‚Šè¾¼ã¿ãƒ»ãƒ­ãƒ¼ãƒ«ã‚¢ãƒƒãƒ—
â”‚   â”‚   â”œâ”€â”€ queue/            # Queues consumerï¼ˆã‚¤ãƒ™ãƒ³ãƒˆé›†è¨ˆã®ãƒ¯ãƒ¼ã‚«ãƒ¼ï¼‰
â”‚   â”‚   â”œâ”€â”€ scheduled/        # Cron Triggersï¼ˆæ™‚æ¬¡/æ—¥æ¬¡é›†è¨ˆãƒ»ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ï¼‰
â”‚   â”‚   â””â”€â”€ integrations/     # Stripe webhookç­‰ã®å¤–éƒ¨é€£æº
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ wrangler.toml
â”‚
â”œâ”€â”€ shared/                    # å…±æœ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ build-tools/          # ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«ç¾¤
â”‚   â”‚   â”œâ”€â”€ ssg-builder.ts
â”‚   â”‚   â”œâ”€â”€ theme-adapter.ts
â”‚   â”‚   â””â”€â”€ cli/
â”‚   â”œâ”€â”€ types/                # å…±æœ‰å‹å®šç¾©
â”‚   â”‚   â”œâ”€â”€ site-config.ts
â”‚   â”‚   â”œâ”€â”€ theme-config.ts
â”‚   â”‚   â””â”€â”€ build-config.ts
â”‚   â””â”€â”€ utils/                # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚       â”œâ”€â”€ file-system.ts
â”‚       â”œâ”€â”€ logger.ts
â”‚       â””â”€â”€ validation.ts
â”‚
â”œâ”€â”€ scripts/                  # çµ±åˆCLIãƒ„ãƒ¼ãƒ«ï¼ˆTypeScriptï¼‰
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ commands/
â”‚   â”‚   â”‚   â”œâ”€â”€ dev.ts       # é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
â”‚   â”‚   â”‚   â”œâ”€â”€ build.ts     # ãƒ“ãƒ«ãƒ‰å®Ÿè¡Œ
â”‚   â”‚   â”‚   â”œâ”€â”€ deploy.ts    # ãƒ‡ãƒ—ãƒ­ã‚¤å‡¦ç†
â”‚   â”‚   â”‚   â””â”€â”€ setup.ts     # ã‚µã‚¤ãƒˆã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”‚   â”œâ”€â”€ sites.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ themes.ts
â”‚   â”‚   â”‚   â””â”€â”€ build.ts
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â””â”€â”€ bin/
â”‚       â”œâ”€â”€ techdoc-dev
â”‚       â”œâ”€â”€ techdoc-build
â”‚       â””â”€â”€ techdoc-deploy
â”‚
â”œâ”€â”€ package.json              # ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒ«ãƒ¼ãƒˆ
â”œâ”€â”€ pnpm-workspace.yaml
â””â”€â”€ README.md
```

## ã‚³ã‚¢ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆ

### 1. ãƒ†ãƒ¼ãƒæŠ½è±¡åŒ–ãƒ¬ã‚¤ãƒ¤ãƒ¼

#### ThemeAdapter ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
```typescript
interface ThemeAdapter {
  name: string
  version: string

  // å¿…é ˆãƒ¡ã‚½ãƒƒãƒ‰
  build(config: BuildConfig): Promise<BuildResult>
  dev(config: DevConfig): Promise<void>

  // æ©Ÿèƒ½ãƒ•ãƒ©ã‚°
  supportsStaticExport(): boolean
  supportsSearchIndex(): boolean
  supportsPaidContent(): boolean

  // è¨­å®š
  defaultConfig: ThemeConfig
}

interface BuildConfig {
  siteId: string
  contentDir: string
  outputPath: string
  themeConfig: Record<string, any>
  env: Record<string, string>
}

interface BuildResult {
  success: boolean
  outputPath: string
  assets: AssetMap[]
  searchIndex?: SearchIndexData
  errors?: string[]
}
```

#### ãƒ†ãƒ¼ãƒãƒ¬ã‚¸ã‚¹ãƒˆãƒª
```typescript
// themes/theme-registry/src/index.ts
class ThemeRegistry {
  private themes = new Map<string, ThemeAdapter>()

  register(adapter: ThemeAdapter): void {
    this.themes.set(adapter.name, adapter)
  }

  get(name: string): ThemeAdapter {
    const theme = this.themes.get(name)
    if (!theme) {
      throw new Error(`Theme '${name}' not found. Available: ${Array.from(this.themes.keys()).join(', ')}`)
    }
    return theme
  }

  list(): string[] {
    return Array.from(this.themes.keys())
  }
}
```

### 2. ã‚µã‚¤ãƒˆè¨­å®šç®¡ç†

#### ã‚µã‚¤ãƒˆè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆdocs.config.tsï¼‰
```typescript
interface SiteConfig {
  // åŸºæœ¬æƒ…å ±
  siteId: string
  theme: string
  domain: string

  // ãƒ†ãƒ¼ãƒè¨­å®š
  themeConfig: Record<string, any>

  // æœ‰æ–™ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¨­å®š
  paidContent?: {
    enabled: boolean
    r2Bucket: string
    jwtSecret: string
    stripeAccountId?: string
    products: ProductConfig[]
  }

  // ãƒ“ãƒ«ãƒ‰è¨­å®š
  build: {
    outputPath: string
    staticExport: boolean
    searchIndex: boolean
  }

  // admin appï¼ˆWorkerï¼‰è¨­å®šï¼ˆçµ±åˆWorker: techdoc/adminï¼‰
  admin: {
    baseUrl: string        // ä¾‹: https://admin-api.example.comï¼ˆCloudflare Workersï¼‰
  }

  // ç’°å¢ƒå¤‰æ•°
  env: Record<string, string>
}
```

### 3. çµ±åˆCLIãƒ„ãƒ¼ãƒ«

#### æ–°ã—ã„ã‚³ãƒãƒ³ãƒ‰ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
```bash
# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npx techdoc dev [site-id] --theme [theme] --port [port]

# ãƒ“ãƒ«ãƒ‰å®Ÿè¡Œ
npx techdoc build [site-id] --theme [theme] --output [path]

# ãƒ‡ãƒ—ãƒ­ã‚¤
npx techdoc deploy [site-id] --production --theme [theme]

# æ–°è¦ã‚µã‚¤ãƒˆã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
npx techdoc setup [site-id] --template [template] --theme [theme]

# ã‚µã‚¤ãƒˆä¸€è¦§è¡¨ç¤º
npx techdoc list --type sites

# ãƒ†ãƒ¼ãƒä¸€è¦§è¡¨ç¤º
npx techdoc list --type themes
```

#### TypeScriptå®Ÿè£…ä¾‹
```typescript
// scripts/src/commands/dev.ts
import { startDevServer } from '../utils/dev-server.js'
import { loadSiteConfig, validateTheme } from '../utils/validation.js'
import { logger } from '../utils/logger.js'

export async function devCommand(options: DevCommandOptions): Promise<void> {
  try {
    logger.info(`â–¶ï¸  Starting development server for: ${options.siteId}`)

    // è¨­å®šèª­ã¿è¾¼ã¿ã¨æ¤œè¨¼
    const config = await loadSiteConfig(options.siteId)
    const theme = options.theme || config.theme
    await validateTheme(theme)

    // é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
    await startDevServer({
      siteId: options.siteId,
      theme,
      port: options.port || 4000,
      watch: options.watch ?? true
    })

    logger.success(`ğŸ¯ Dev server: http://localhost:${options.port || 4000}`)

  } catch (error) {
    logger.error(`âŒ Failed to start dev server: ${error.message}`)
    process.exit(1)
  }
}
```

## æœ‰æ–™ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æ©Ÿèƒ½è¨­è¨ˆ

### æŠ€è¡“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```mermaid
graph TD
    A[ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ] --> B["admin appï¼ˆWorkerï¼‰"]
    B --> C[JWTæ¤œè¨¼]
    C --> D[æ¨©é™ç¢ºèª]
    D --> E[R2ç½²åURLç”Ÿæˆ]
    E --> F[R2ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸]
    F --> G[ã‚³ãƒ³ãƒ†ãƒ³ãƒ„é…ä¿¡]

    H[æ±ºæ¸ˆãƒ•ãƒ­ãƒ¼] --> I[Stripe API]
    I --> J[Webhookå‡¦ç†]
    J --> K[æ¨©é™æ›´æ–°]
```

### MDXæ‹¡å¼µä»•æ§˜

#### æœ‰æ–™ã‚»ã‚¯ã‚·ãƒ§ãƒ³æ§‹æ–‡
```mdx
import { PaidSection } from 'content/paid'

ã“ã“ã¯ç„¡æ–™ã®æœ¬æ–‡ã€‚

[premium productId="product:course-v0" id="lesson-1"]

## ãƒ¬ãƒƒã‚¹ãƒ³1

â€¦ã“ã“ã‹ã‚‰æœ‰æ–™æœ¬æ–‡â€¦

![ç”»åƒèª¬æ˜](./assets/secret.png)

...

[/premium]

ã“ã“ã‚‚ç„¡æ–™æœ¬æ–‡ã€‚
```

### å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

#### ãƒ“ãƒ«ãƒ‰æ™‚å‡¦ç†
1. MDX ASTã‚’è§£æã—ã€`[premium]~[/premium]`ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ¤œå‡º
2. æœ‰æ–™æœ¬æ–‡ã‚’æŠ½å‡ºã—ã¦JSONåŒ–
3. æŠ½å‡ºæœ¬æ–‡ã¯SSGå‡ºåŠ›ã«å«ã‚ãšã€R2ã«ä¿å­˜
4. ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ã‚’é™çš„HTMLã«å‡ºåŠ›

#### é…ä¿¡æ™‚å‡¦ç†
1. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒæœ‰æ–™ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹
2. admin appï¼ˆWorkerï¼‰ï¼ˆçµ±åˆWorker: `techdoc/admin`ï¼‰ã§JWTã‚’æ¤œè¨¼ã—ã€æ¨©é™ç¢ºèª
3. æ¨©é™ãŒã‚ã‚‹å ´åˆã€R2ã®ç½²åURLã‚’ç™ºè¡Œ
4. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒç½²åURLã‹ã‚‰ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å–å¾—ãƒ»è¡¨ç¤º

## CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆ

### GitHub Actionsãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

#### .github/workflows/deploy.yml
```yaml
name: Deploy Documentation
on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  detect-changes:
    runs-on: ubuntu-latest
    outputs:
      theme: ${{ steps.config.outputs.theme }}
      has-docs-changes: ${{ steps.changes.outputs.docs }}
    steps:
      - uses: actions/checkout@v4
      - name: Detect theme
        id: config
        run: |
          theme=$(node -e "
            const config = require('./docs.config.json');
            console.log(config.theme || 'fumadocs');
          ")
          echo "theme=$theme" >> $GITHUB_OUTPUT

      - name: Check docs changes
        id: changes
        run: |
          if [[ "${{ github.event_name }}" == "pull_request" ]]; then
            changed=$(git diff --name-only origin/${{ github.base_ref }} HEAD)
          else
            changed=$(git diff --name-only HEAD~1 HEAD)
          fi

          if echo "$changed" | grep -E "^contents/"; then
            echo "docs=true" >> $GITHUB_OUTPUT
          else
            echo "docs=false" >> $GITHUB_OUTPUT
          fi

  build-docs:
    needs: detect-changes
    if: needs.detect-changes.outputs.has-docs-changes == 'true'
    runs-on: ubuntu-latest
    strategy:
      matrix:
        theme: [fumadocs, nextra, docusaurus]
        include:
          - theme: fumadocs
            build-command: "pnpm build:export"
            output-dir: "out"
          - theme: nextra
            build-command: "pnpm build"
            output-dir: "out"
          - theme: docusaurus
            build-command: "pnpm build"
            output-dir: "build"

    steps:
      - uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'pnpm'

      - name: Install dependencies
        run: |
          pnpm install --frozen-lockfile
          if [ "${{ matrix.theme }}" == "fumadocs" ]; then
            cd themes/${{ matrix.theme }} && pnpm install --frozen-lockfile
          fi

      - name: Build documentation
        run: |
          export SITE_ID="${{ github.event.repository.name }}"
          export THEME_ID="${{ matrix.theme }}"
          export SSG_EXPORT=1
          cd themes/${{ matrix.theme }}
          ${{ matrix.build-command }}

      - name: Upload build artifacts
        uses: actions/upload-artifact@v4
        with:
          name: docs-${{ matrix.theme }}
          path: ${{ matrix.output-dir }}

  deploy-production:
    needs: [detect-changes, build-docs]
    if: github.ref == 'refs/heads/main' && needs.detect-changes.outputs.has-docs-changes == 'true'
    runs-on: ubuntu-latest
    steps:
      - name: Download artifacts
        uses: actions/download-artifact@v4
        with:
          name: docs-${{ needs.detect-changes.outputs.theme }}
          path: build-output

      - name: Deploy to Cloudflare Pages
        uses: cloudflare/pages-action@v1
        with:
          apiToken: ${{ secrets.CLOUDFLARE_API_TOKEN }}
          accountId: ${{ secrets.CLOUDFLARE_ACCOUNT_ID }}
          projectName: ${{ github.event.repository.name }}
          directory: build-output
          deployment-trigger: push
```

## Cloudflare Pagesé€£æº

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®š
- **ãƒªãƒã‚¸ãƒˆãƒª**: å„ã‚µã‚¤ãƒˆã®GitHubãƒªãƒã‚¸ãƒˆãƒªã‚’é€£æº
- **ãƒ“ãƒ«ãƒ‰ã‚³ãƒãƒ³ãƒ‰**: `pnpm build`ï¼ˆGitHub Actionsã§å®Ÿè¡Œï¼‰
- **å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª**: `out`ï¼ˆfumadocsã®å ´åˆï¼‰
- **ç’°å¢ƒå¤‰æ•°**:
  - `CLOUDFLARE_API_TOKEN`
  - `SITE_ID`
  - `THEME_ID`
  - `ADMIN_APP_BASE_URL`ï¼ˆadmin appï¼ˆWorkerï¼‰ã®ãƒ™ãƒ¼ã‚¹URLã€‚ä¾‹: `https://admin-api.example.com`ï¼‰

### ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³è¨­å®š
- **v0ã‚µã‚¤ãƒˆ**: `v0.techdoc.dev`
- **nextjsã‚µã‚¤ãƒˆ**: `nextjs.techdoc.dev`
- **cloudflareã‚µã‚¤ãƒˆ**: `cloudflare.techdoc.dev`

### admin UIï¼ˆPagesï¼‰
- å½¹å‰²: ç®¡ç†ç”»é¢ï¼ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰/è¨­å®šç”»é¢ï¼‰ã€‚admin appï¼ˆWorkerï¼‰ã‚’å‘¼ã³å‡ºã—ã¦é‹ç”¨ãƒ»å¯è¦–åŒ–ã‚’è¡Œã†
- é…ä¿¡: Cloudflare Pagesï¼ˆä¾‹: `https://admin.example.com`ï¼‰\n+- è¨­å®š: `ADMIN_APP_BASE_URL` ã‚’å‚ç…§ã—ã¦APIå‘¼ã³å‡ºã—å…ˆã‚’çµ±ä¸€

### admin appï¼ˆWorkerï¼‰ï¼ˆCloudflare Workers: techdoc/adminï¼‰
- å½¹å‰²: ã‚µã‚¤ãƒˆ/ãƒšãƒ¼ã‚¸/ãƒ†ãƒ¼ãƒ/æœ‰æ–™ã‚³ãƒ³ãƒ†ãƒ³ãƒ„/è¨ˆæ¸¬ï¼ˆpage_viewï¼‰ã‚’ **1ã¤ã®Workerã‚¢ãƒ—ãƒª**ã¨ã—ã¦æä¾›
- ãƒ‡ãƒ¼ã‚¿: D1ï¼ˆãƒ¡ã‚¿/æ¨©é™/é›†è¨ˆãƒ­ãƒ¼ãƒ«ã‚¢ãƒƒãƒ—ï¼‰ã€R2ï¼ˆæœ‰æ–™ã‚¢ã‚»ãƒƒãƒˆ/æŠ½å‡ºæœ¬æ–‡ï¼‰ã€Queuesï¼ˆã‚¤ãƒ™ãƒ³ãƒˆãƒãƒƒãƒ•ã‚¡ï¼‰
- ãƒˆãƒªã‚¬: HTTPï¼ˆadminã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼‰ã€Queue consumerã€Cronï¼ˆæ™‚æ¬¡/æ—¥æ¬¡é›†è¨ˆï¼‰ã‚’åŒä¸€Workerã«çµ±åˆ

## å®Ÿè£…ãƒ•ã‚§ãƒ¼ã‚º

### Phase 1: åŸºç›¤æ•´å‚™ï¼ˆ1-2é€±é–“ï¼‰
- [ ] ãƒ†ãƒ¼ãƒæŠ½è±¡åŒ–ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®å®Ÿè£…
- [ ] ã‚µã‚¤ãƒˆè¨­å®šã®æ¨™æº–åŒ–
- [ ] CLIãƒ„ãƒ¼ãƒ«ã®TypeScriptåŒ–
- [ ] admin appï¼ˆWorkerï¼‰ï¼ˆçµ±åˆWorkerï¼‰ã®åŸºæœ¬å®Ÿè£…

### Phase 2: CI/CDæ•´å‚™ï¼ˆ2-4é€±é–“ï¼‰
- [ ] GitHubãƒªãƒã‚¸ãƒˆãƒªåˆ†å‰²
- [ ] GitHub Actionsãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ§‹ç¯‰
- [ ] Cloudflare Pagesé€£æº
- [ ] ãƒãƒ«ãƒã‚µã‚¤ãƒˆç®¡ç†ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆadmin UIï¼ˆPagesï¼‰ï¼‰

### Phase 3: æœ‰æ–™ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æ©Ÿèƒ½ï¼ˆ4-8é€±é–“ï¼‰
- [ ] MDXãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè£…
- [ ] èªè¨¼ãƒ»èªå¯ã‚·ã‚¹ãƒ†ãƒ 
- [ ] Stripeæ±ºæ¸ˆé€£æº
- [ ] ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä¿è­·æ©Ÿèƒ½

### Phase 4: é‹ç”¨ãƒ»ç›£è¦–ï¼ˆä¸¦è¡Œå®Ÿæ–½ï¼‰
- [ ] æœ¬ç•ªç’°å¢ƒæ§‹ç¯‰
- [ ] ç›£è¦–ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆä½“åˆ¶
- [ ] é‹ç”¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™
- [ ] ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°è³‡æ–™ä½œæˆ

## äº’æ›æ€§ã¨ç§»è¡Œè¨ˆç”»

### ã‚³ãƒãƒ³ãƒ‰äº’æ›æ€§
```bash
# ç¾è¡Œï¼ˆç¶­æŒæœŸé–“ä¸­ï¼‰
./dev.sh v0 fumadocs
./deploy.sh v0 fumadocs

# æ–°æ–¹å¼ï¼ˆæ¨å¥¨ï¼‰
npx techdoc dev v0 --theme fumadocs
npx techdoc deploy v0 --theme fumadocs --production
```

### ç§»è¡Œæˆ¦ç•¥
1. **ä¸¦è¡Œé‹ç”¨æœŸé–“**: 3ãƒ¶æœˆé–“ã€ä¸¡æ–¹ã®æ–¹å¼ã‚’ã‚µãƒãƒ¼ãƒˆ
2. **æ®µéšçš„ç§»è¡Œ**: ã‚µã‚¤ãƒˆã”ã¨ã«æ–°ã—ã„æ–¹å¼ã«ç§»è¡Œ
3. **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™**: ç§»è¡Œã‚¬ã‚¤ãƒ‰ã¨ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ä½œæˆ
4. **ã‚µãƒãƒ¼ãƒˆä½“åˆ¶**: ç§»è¡ŒæœŸé–“ä¸­ã®æŠ€è¡“ã‚µãƒãƒ¼ãƒˆä½“åˆ¶

## æˆåŠŸæŒ‡æ¨™

### æŠ€è¡“æŒ‡æ¨™
- **ãƒ“ãƒ«ãƒ‰æ™‚é–“**: ç¾è¡Œæ¯”80%å‰Šæ¸›
- **ãƒ‡ãƒ—ãƒ­ã‚¤æˆåŠŸç‡**: 99%ä»¥ä¸Š
- **ã‚µã‚¤ãƒˆè¿½åŠ å·¥æ•°**: ç¾è¡Œæ¯”90%å‰Šæ¸›
- **ã‚¨ãƒ©ãƒ¼æ¤œå‡ºç‡**: 95%ä»¥ä¸Š

### ãƒ“ã‚¸ãƒã‚¹æŒ‡æ¨™
- **æœ‰æ–™ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è²©å£²æ•°**: ç›®æ¨™100ä»¶/æœˆ
- **æ–°è¦ã‚µã‚¤ãƒˆè¿½åŠ æ•°**: 5ã‚µã‚¤ãƒˆ/å››åŠæœŸ
- **é–‹ç™ºç”Ÿç”£æ€§**: 200%å‘ä¸Š
- **é‹ç”¨ã‚³ã‚¹ãƒˆ**: 60%å‰Šæ¸›

## ãƒªã‚¹ã‚¯ç®¡ç†

### æŠ€è¡“çš„ãƒªã‚¹ã‚¯
- **è¤‡é›‘æ€§å¢—å¤§**: æŠ½è±¡åŒ–ãƒ¬ã‚¤ãƒ¤ãƒ¼ã§å¯¾å¿œ
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åŠ£åŒ–**: ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥ã¨æœ€é©åŒ–ã§å¯¾å¿œ
- **ç§»è¡Œãƒªã‚¹ã‚¯**: æ®µéšçš„ç§»è¡Œã¨ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯è¨ˆç”»

### é‹ç”¨ãƒªã‚¹ã‚¯
- **å­¦ç¿’ã‚³ã‚¹ãƒˆ**: ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°è¨ˆç”»ã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™
- **ä¾å­˜é–¢ä¿‚ã®è¤‡é›‘åŒ–**: æ¨™æº–åŒ–ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã§å¯¾å¿œ
- **äºˆç®—è¶…é**: æ®µéšçš„æŠ•è³‡ã¨ROIè©•ä¾¡

## ä»Šå¾Œã®æ‹¡å¼µè¨ˆç”»

### çŸ­æœŸï¼ˆ6ãƒ¶æœˆï¼‰
- æ–°ãƒ†ãƒ¼ãƒï¼ˆdx-mediaï¼‰ã®å®Œå…¨å®Ÿè£…
- è©³ç´°ãªåˆ†æãƒ»ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½
- å¤šè¨€èªå¯¾å¿œ
- APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè‡ªå‹•ç”Ÿæˆ

### ä¸­æœŸï¼ˆ1å¹´ï¼‰
- ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºæ©Ÿèƒ½ï¼ˆSSOã€æ¨©é™ç®¡ç†ï¼‰
- ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ï¼ˆå…±åŒç·¨é›†ï¼‰
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
- ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªå¯¾å¿œ

### é•·æœŸï¼ˆ2å¹´ï¼‰
- AIæ©Ÿèƒ½çµ±åˆï¼ˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç”Ÿæˆã€è¦ç´„ï¼‰
- ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ æ‹¡å……ï¼ˆãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã€ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹ï¼‰
- ã‚°ãƒ­ãƒ¼ãƒãƒ«å±•é–‹ï¼ˆå¤šè¨€èªã€ãƒªãƒ¼ã‚¸ãƒ§ãƒ³å¯¾å¿œï¼‰

---

*æœ¬è¨­è¨ˆæ›¸ã¯ç¶™ç¶šçš„ã«æ›´æ–°ã•ã‚Œã¾ã™ã€‚å¤‰æ›´ã‚„æ”¹å–„ææ¡ˆã¯Redmine issue #2049ã§ç®¡ç†ã—ã¾ã™ã€‚*

