---
title: テキスト処理の実践レシピ | シェルスクリプト開発ガイド
slug: text-processing
status: publish
post_type: page
seo_keywords: "シェルスクリプト, テキスト処理, sed, awk, grep, CSV処理"
seo_description: "シェルスクリプトによるテキスト処理の実践的なレシピ集。sed、awk、grepを使った高度なテキスト操作からCSVファイルの処理まで、実務で役立つ具体的な実装例を紹介します。"
tags: ["シェルスクリプト", "テキスト処理", "sed", "awk", "grep", "CSV"]
image: "/images/shell-script/text-processing.png"
parent: "practical-recipes"
---

## 📝 テキスト処理の実践レシピ

テキスト処理はシェルスクリプトの醍醐味です。ログファイルの分析、設定ファイルの編集、データの変換など、テキスト処理スキルはシステム管理や開発業務で不可欠です。このセクションでは、強力なテキスト処理ツールを使った実践的なレシピを紹介します。

### このカテゴリで学べる事

:::note このカテゴリで学べる事

- sedを使った高度な文字列置換と編集
- awkによるレポート生成とデータ分析
- grepを使った効率的なテキスト検索と抽出
- CSVファイルの処理と変換
- 各ツールの組み合わせによる複雑な処理

:::

## 🎯 なぜテキスト処理スキルが重要か？

:::note テキスト処理の重要性

現代のシステムでは、大量のテキストデータが日々生成されます：

- **ログファイルの分析**: システムの状態把握と問題検出
- **設定ファイルの一括編集**: 複数サーバーの設定変更
- **データの変換**: 異なるフォーマット間のデータ移行
- **レポートの自動生成**: 定期的なステータスレポート作成

これらのタスクを手動で行うのは非効率的です。シェルスクリプトのテキスト処理ツールを使えば、**高速**かつ**正確**に大量のテキストデータを処理できます。

:::

## 📖 実践レシピ一覧

### 🔍 grepによるテキスト検索と抽出

[grep検索と抽出の詳細ガイド](./grep-extraction.md)

grepはテキスト処理の基本ツールです。特定のパターンを含む行を検索し、必要な情報を抽出する方法を学びます。正規表現を活用した高度な検索技術も紹介します。

**主な内容:**
- 基本的なパターンマッチング
- 正規表現を使った高度な検索
- マッチしない行の抽出（`-v` オプション）
- ファイル名と行番号の表示
- 再帰的検索と複数ファイル処理

```bash
# エラーログの抽出
grep "ERROR" /var/log/app.log
grep -n "FATAL" /var/log/app.log | head -5

# 複数のエラーレベルを一度に検索
grep -E "(ERROR|WARN|FATAL)" /var/log/app.log
```

### ✏️ sedによる文字列置換と編集

[sed置換の詳細ガイド](./sed-substitution.md)

sed（Stream Editor）は、テキストの編集をストリーム処理で行う強力なツールです。文字列の置換、行の削除・挿入、パターンに基づく編集など、実務で役立つ処理を学びます。

**主な内容:**
- 基本的な文字列置換（`s/old/new/g`）
- 行番号を指定した編集
- 正規表現を使った条件付き置換
- 複数ファイルの一括編集
- バックアップ付きの編集

```bash
# 設定ファイルの値を一括置換
sed -i 's/localhost/127.0.0.1/g' config.ini

# コメント行を削除
sed '/^#/d' configuration.txt

# 行末にテキストを追加
sed 's/$/;/' script.js
```

### 📊 awkによるレポート生成とデータ分析

[awkレポート生成の詳細ガイド](./awk-reporting.md)

awkは、テキストデータを処理するためのプログラミング言語です。列指向のデータ処理、集計、レポート生成など、より高度なテキスト処理を実現します。

**主な内容:**
- 列の抽出と加工（`$1`, `$2`, `$NF`）
- 条件に基づく行の選択
- 集計処理と合計値の計算
- 複雑なレポートの生成
- 組み込み変数と関数の活用

```bash
# ログファイルからIPアドレスを集計
awk '{print $1}' access.log | sort | uniq -c | sort -nr

# CSVファイルの特定列を抽出
awk -F, '{print $1, $3}' data.csv

# 条件に基づくデータ抽出
awk '$5 > 1000 {print $0}' sales.txt
```

### 📋 CSVファイルの処理と変換

[CSV処理の詳細ガイド](./csv-manipulation.md)

CSVファイルはデータ交換の一般的なフォーマットです。シェルスクリプトでCSVファイルを読み込み、加工、変換する方法を学びます。データの検証、整形、出力までを実践的に紹介します。

**主な内容:**
- CSVファイルの読み込みとパース
- 列の並べ替えと選択
- データの検証とクリーニング
- 異なるフォーマットへの変換
- 大規模CSVファイルの効率的な処理

```bash
# CSVファイルからヘッダー行を取得
head -1 data.csv

# 2列目と4列目を抽出
awk -F, '{print $2, $4}' data.csv

# CSVをTSVに変換
sed 's/,/\t/g' data.csv > data.tsv
```

## 🛠️ 実践的な活用シーン

### ログファイルの分析

**エラーログの集計**
```bash
# エラーの種類ごとに集計
grep "ERROR" /var/log/app.log | awk '{print $5}' | sort | uniq -c | sort -nr

# 時間帯別のエラー数を集計
grep "ERROR" /var/log/app.log | awk '{print substr($4,2,2)}' | sort | uniq -c
```

**アクセスログの分析**
```bash
# アクセス数の多いIPを抽出
awk '{print $1}' /var/log/nginx/access.log | sort | uniq -c | sort -nr | head -10

# ステータスコードごとの集計
awk '{print $9}' /var/log/nginx/access.log | sort | uniq -c | sort -nr
```

### 設定ファイルの一括管理

**複数サーバーの設定変更**
```bash
# 複数の設定ファイルでバージョン番号を更新
find /etc/app/ -name "*.conf" -exec sed -i 's/version=1.0/version=1.1/g' {} \;

# コメントアウトされた設定を有効化
sed -i 's/^#\(debug_mode\)/\1/' /etc/app/config.ini
```

### データの変換と整形

**ログデータの整形**
```bash
# 複数行のログを1行に変換
awk '/^[0-9]/{if(line) print line; line=$0; next} {line=line " " $0} END{if(line) print line}' multi-line.log

# タイムスタンプのフォーマット変換
sed 's/\[.*\]/\t/' raw.log | awk '{print $1, $4}'
```

## 💡 ベストプラクティス

### パフォーマンスの最適化

1. **適切なツールの選択**
   - 単純な検索: `grep`
   - 文字列置換: `sed`
   - 列処理と集計: `awk`
   - 複雑な処理: ツールの組み合わせ

2. **大規模ファイルの処理**
   - `head`、`tail` を使って必要な部分だけ処理
   - 一時ファイルを活用してメモリ使用量を削減
   - パイプラインで処理を効率化

3. **正規表現の最適化**
   - 必要以上に複雑な正規表現を避ける
   - 貪欲マッチと非貪欲マッチを適切に使い分ける
   - グループ化とキャプチャを適切に使用

### エラーハンドリング

1. **入力データの検証**
   - ファイルの存在確認
   - データフォーマットのチェック
   - 空行や不正データの処理

2. **処理結果の確認**
   - 変更前後の比較
   - 処理件数のカウント
   - エラーログの出力

3. **バックアップの取得**
   - 重要なファイルの編集前に必ずバックアップ
   - `sed -i.bak` で自動バックアップ

## 🔗 関連リンク

- [正規表現の基本](../basic-syntax/regular-expressions.md)
- [パイプとリダイレクト](../io-control/pipes.md)
- [ファイル操作の実践レシピ](../file-directory-operations/)
- [スクリプトのデバッグ技法](../best-practices/debugging/)

## まとめ

テキスト処理スキルは、シェルスクリプトプログラマーにとって最も強力な武器の一つです。grep、sed、awkを使いこなすことで、大量のテキストデータを効率的に処理し、複雑な分析タスクを自動化できます。

:::note 要点のまとめ

- grepはパターン検索の基本ツール
- sedはストリーム処理でテキスト編集を行う
- awkは列指向のデータ処理と集計に最適
- CSV処理はデータ変換の重要なスキル
- ツールの組み合わせで複雑な処理を実現

:::

次は、より高度な[プロセス・ジョブ管理の実践レシピ](../process-job-management/)に進みましょう。プロセス管理スキルを身につけることで、長時間実行する処理を効率的に管理できるようになります。